import{u as y,r as o,j as e}from"./index-D7VU_rEH.js";const j=()=>{const{token:n,user:r}=y(),[d,l]=o.useState([]),[b,h]=o.useState(!0),[u,x]=o.useState(null);o.useEffect(()=>{(async()=>{h(!0),x(null);try{const t=await fetch("https://sublite-wmu2.onrender.com/api/admin/users",{headers:{Authorization:`Bearer ${n}`}});if(!t.ok)throw new Error("Failed to fetch users");const i=await t.json();l(i)}catch(t){x(t.message)}finally{h(!1)}})()},[n]);const p=async s=>{if(window.confirm("Are you sure you want to delete this user?"))try{const t=await fetch(`https://sublite-wmu2.onrender.com/api/users/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${n}`}}),i=await t.json();if(!t.ok)throw new Error(i.message||"Failed to delete user");l(d.filter(a=>a._id!==s)),alert("User deleted successfully.")}catch(t){alert(t.message)}},w=async(s,t)=>{const i=t?"remove admin rights from":"make admin";if(window.confirm(`Are you sure you want to ${i} this user?`))try{const a=await fetch(`https://sublite-wmu2.onrender.com/api/users/${s}/role`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({isAdmin:!t})}),c=await a.json();if(!a.ok)throw new Error(c.message||"Failed to update admin status");l(d.map(m=>m._id===s?{...m,isAdmin:c.isAdmin}:m)),alert(`User is now ${c.isAdmin?"an admin":"a regular user"}.`)}catch(a){alert(a.message)}};return b?e.jsx("div",{children:"Loading users..."}):u?e.jsx("div",{className:"text-red-600",children:u}):e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"User Management"}),e.jsxs("table",{className:"min-w-full bg-white border rounded shadow",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b",children:"Name"}),e.jsx("th",{className:"py-2 px-4 border-b",children:"Email"}),e.jsx("th",{className:"py-2 px-4 border-b",children:"Role"}),e.jsx("th",{className:"py-2 px-4 border-b",children:"Actions"})]})}),e.jsx("tbody",{children:d.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-4 border-b",children:s.name}),e.jsx("td",{className:"py-2 px-4 border-b",children:s.email}),e.jsx("td",{className:"py-2 px-4 border-b",children:s.isAdmin?"Admin":"User"}),e.jsxs("td",{className:"py-2 px-4 border-b",children:[s._id===(r==null?void 0:r._id)?e.jsx("button",{className:"bg-gray-300 text-gray-600 px-3 py-1 rounded cursor-not-allowed",disabled:!0,children:"Delete"}):e.jsx("button",{className:"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600",onClick:()=>p(s._id),children:"Delete"}),s._id!==(r==null?void 0:r._id)&&e.jsx("button",{className:`ml-2 px-3 py-1 rounded ${s.isAdmin?"bg-yellow-500 text-white hover:bg-yellow-600":"bg-blue-500 text-white hover:bg-blue-600"}`,onClick:()=>w(s._id,s.isAdmin),children:s.isAdmin?"Remove Admin":"Make Admin"})]})]},s._id))})]})]})};export{j as default};
//# sourceMappingURL=UserManagement-2ZA1P1n4.js.map
