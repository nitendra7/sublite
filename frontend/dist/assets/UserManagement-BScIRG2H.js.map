{"version":3,"file":"UserManagement-BScIRG2H.js","sources":["../../src/components/admin/UserManagement.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useUser } from '../../context/UserContext';\n\nconst UserManagement = () => {\n  const { token, user: currentUser } = useUser();\n  const [users, setUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    const fetchUsers = async () => {\n      setLoading(true);\n      setError(null);\n      try {\n        const res = await fetch(`${import.meta.env.VITE_API_BASE_URL || 'http://localhost:5000'}/api/admin/users`, {\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        if (!res.ok) throw new Error('Failed to fetch users');\n        const data = await res.json();\n        setUsers(data);\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchUsers();\n  }, [token]);\n\n  const handleDelete = async (userId) => {\n    if (!window.confirm('Are you sure you want to delete this user?')) return;\n    try {\n              const res = await fetch(`${import.meta.env.VITE_API_BASE_URL || 'http://localhost:5000'}/api/users/${userId}`, {\n        method: 'DELETE',\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      const data = await res.json();\n      if (!res.ok) throw new Error(data.message || 'Failed to delete user');\n      setUsers(users.filter(u => u._id !== userId));\n      alert('User deleted successfully.');\n    } catch (err) {\n      alert(err.message);\n    }\n  };\n\n  const handleToggleAdmin = async (userId, currentIsAdmin) => {\n    const action = currentIsAdmin ? 'remove admin rights from' : 'make admin';\n    if (!window.confirm(`Are you sure you want to ${action} this user?`)) return;\n    try {\n              const res = await fetch(`${import.meta.env.VITE_API_BASE_URL || 'http://localhost:5000'}/api/users/${userId}/role`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ isAdmin: !currentIsAdmin }),\n      });\n      const data = await res.json();\n      if (!res.ok) throw new Error(data.message || 'Failed to update admin status');\n      setUsers(users.map(u => u._id === userId ? { ...u, isAdmin: data.isAdmin } : u));\n      alert(`User is now ${data.isAdmin ? 'an admin' : 'a regular user'}.`);\n    } catch (err) {\n      alert(err.message);\n    }\n  };\n\n  if (loading) return <div>Loading users...</div>;\n  if (error) return <div className=\"text-red-600\">{error}</div>;\n\n  return (\n    <div>\n      <h2 className=\"text-xl font-bold mb-4\">User Management</h2>\n      <table className=\"min-w-full bg-white border rounded shadow\">\n        <thead>\n          <tr>\n            <th className=\"py-2 px-4 border-b\">Name</th>\n            <th className=\"py-2 px-4 border-b\">Email</th>\n            <th className=\"py-2 px-4 border-b\">Role</th>\n            <th className=\"py-2 px-4 border-b\">Actions</th>\n          </tr>\n        </thead>\n        <tbody>\n          {users.map(user => (\n            <tr key={user._id}>\n              <td className=\"py-2 px-4 border-b\">{user.name}</td>\n              <td className=\"py-2 px-4 border-b\">{user.email}</td>\n              <td className=\"py-2 px-4 border-b\">{user.isAdmin ? 'Admin' : 'User'}</td>\n              <td className=\"py-2 px-4 border-b\">\n                {user._id === currentUser?._id ? (\n                  <button className=\"bg-gray-300 text-gray-600 px-3 py-1 rounded cursor-not-allowed\" disabled>Delete</button>\n                ) : (\n                  <button\n                    className=\"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600\"\n                    onClick={() => handleDelete(user._id)}\n                  >\n                    Delete\n                  </button>\n                )}\n                {user._id !== currentUser?._id && (\n                  <button\n                    className={`ml-2 px-3 py-1 rounded ${user.isAdmin ? 'bg-yellow-500 text-white hover:bg-yellow-600' : 'bg-blue-500 text-white hover:bg-blue-600'}`}\n                    onClick={() => handleToggleAdmin(user._id, user.isAdmin)}\n                  >\n                    {user.isAdmin ? 'Remove Admin' : 'Make Admin'}\n                  </button>\n                )}\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n};\n\nexport default UserManagement; "],"names":["UserManagement","token","currentUser","useUser","users","setUsers","useState","loading","setLoading","error","setError","useEffect","res","data","err","handleDelete","userId","u","handleToggleAdmin","currentIsAdmin","action","jsx","jsxs","user"],"mappings":"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"}